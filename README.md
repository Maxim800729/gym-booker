# RigertWorkout / Gym Booker

Учебный проект для бронирования тренировок в спортивном зале.

Проект рассчитан на демонстрацию на защите и на запуск “как у проверяющего” — одной командой через Docker Compose.

---

## Стек

- Java 21  
- Spring Boot  
- Spring Data JPA / Hibernate  
- Flyway  
- Microsoft SQL Server  
- Docker / Docker Compose  

---

## Возможности

- просмотр расписания занятий  
- запись клиента на занятия по email  
- личный кабинет клиента  
- админка для просмотра и управления бронями  
- отметка оплаты и “оплачено до”  

---

## Быстрый старт (рекомендуемый)

### Требования

- установленный **Docker Desktop**

### Запуск на чистой базе

В корне проекта, где лежит `docker-compose.yml`:

```bash
docker compose down -v --remove-orphans
docker compose up --build
```

После запуска Flyway сам создаст схему и заполнит базовыми данными.

### Просмотр логов

В отдельном терминале:

```bash
docker compose logs -f
```

Выход из просмотра логов — `Ctrl + C` (контейнеры продолжат работать).

---

## Адреса

Проверь секцию `ports` в `docker-compose.yml`.

Чаще всего используется:

```yaml
ports:
  - "8081:8080"
```

Тогда:

- Главная: `http://localhost:8081/`
- Личный кабинет: `http://localhost:8081/cabinet`
- Админка: `http://localhost:8081/admin/continue`

---

## База данных и миграции

Миграции Flyway находятся здесь:

```
src/main/resources/db/migration
```

Текущие версии:

- `V1__init.sql`
- `V2__init_clients.sql`
- `V3__coaches_and_session_coach.sql`
- `V4__add_paid_to_bookings.sql`
- `V5__add_password_to_clients.sql`

### Важно про миграции

Ранние миграции уже были поправлены в рамках учебного проекта.

✅ С этого момента **не изменяй** `V1–V5`.  
Если нужно новое изменение схемы — добавляй **новую** миграцию `V6__...`.

---

## Сиды (данные по умолчанию)

После чистого запуска создаются:

### Зал

- один зал (по концепции проекта)

### Тренеры

- **Ригерт Владислав**
- **Долгачев Александр**

### Типы занятий

- Тяжелая атлетика  
- Кроссфит  
- ОФП  

### Расписание

В `V3__coaches_and_session_coach.sql` зашиты фиксированные даты/время,
чтобы после сброса расписание не “плавало”.

---

## Тест “как у проверяющего”

Полный сценарий проверки проекта на защите:

```bash
docker compose down -v --remove-orphans
docker compose up --build
```

Если после этого:
- приложение стартует,
- страницы открываются,
- админка показывает брони,

значит релизный сценарий готов.

---

## Полезные команды

Остановить контейнеры:

```bash
docker compose down
```

Полный сброс БД (удаление томов):

```bash
docker compose down -v --remove-orphans
```

Поднять с пересборкой:

```bash
docker compose up --build
```

---

## Возможные проблемы

### “Страница не активна” / интерфейс будто завис

Иногда это кеш браузера после смены сида/расписания.

Решение:
- обновить жестко: `Ctrl + F5`
- или открыть в **инкогнито**

### Ошибки входа в MSSQL вида `NT AUTHORITY\\ANONYMOUS LOGON`

Это обычно шум от попыток внешних инструментов подключиться без нужных кредов.
Если приложение работает — можно игнорировать.

---

## Как выложить на GitHub

1) В корне проекта:

```bash
git init
git add .
git commit -m "Initial commit"
```

2) Создай репозиторий на GitHub.

3) Привяжи remote и запушь:

```bash
git remote add origin <URL_твоего_репозитория>
git branch -M main
git push -u origin main
```

---

## Что должно быть в репозитории

Обязательно:

- `docker-compose.yml`
- `Dockerfile`
- `pom.xml`
- `mvnw`, `mvnw.cmd`, `.mvn/`
- `src/main/resources/db/migration/*.sql`
- `README.md`

---

## .gitignore (рекомендуемый)

Если у тебя нет `.gitignore`, добавь:

```gitignore
/target
/.idea
*.iml
.DS_Store
.env
```

---

## Лицензия

Учебный проект.
